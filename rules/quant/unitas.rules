#-*- mode:snakemake -*-


rule unitas:
    input:
        fastq = get_filtered_fastq
    params:
        org = 'homo_sapiens',
        tmpdir = 'data/tmp/unitas',
        outdir = 'data/processed/smallrna/unitas/{sample}/'
    output:
        'data/processed/unitas/{sample}/ncRNA_counts.html'
    singularity:
        'docker://flatberg/unitas:1.6.0'
    shell:
        """
        mkdir -p {params.tmpdir}
        cd {params.tmpdir}
        unitas.pl -input {input.fastq} -s {params.org} - output_prefix={params.tmpdir}
        mv {params.tmpdir}/*#1*/* {params.outdir}
        """
